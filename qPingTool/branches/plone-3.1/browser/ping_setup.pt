<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="qPingTool">

  <body>

    <div metal:fill-slot="main"
         tal:define="pingProperties python: here.portal_pingtool.getPingProperties(here)">

      <h1 i18n:translate="heading_edit_item">
        Edit
        <span i18n:name="itemtype">
          <span i18n:translate=""
                tal:content="python:here.getTypeInfo().Title()"
                tal:omit-tag="">Item type</span>
        </span>
      </h1>

      <p i18n:translate="description_edit_document">
        Fill in the details of this document.
      </p>
      <div tal:define="message view/ping_message" tal:omit-tag="" tal:condition="message">
        <pre tal:content="message"/>
      </div>
      <form name="edit_form"
            action="."
            method="post"
            enctype="multipart/form-data"
            tal:attributes="action string:${context/absolute_url}/@@ping_setup" >

        <fieldset>

          <legend i18n:translate="legend_ping_setup">Ping Setup Details</legend>

          <div class="field">
            <input type="checkbox"
                   id="enable_ping"
                   name="enable_ping"
                   tal:attributes="checked python:pingProperties['enable_ping'] and 'checked' or None"
                   />
            <label for="enable_ping" i18n:translate="label_enable_ping">Enable Ping</label>
          </div>

          <div class="field" 
	       tal:define="ping_sites python:pingProperties['ping_sites']">

           <tal:block repeat="id here/portal_pingtool/objectIds"> 
             <input type="checkbox"
                    id="id"
                    name="ping_sites:list"
                    tal:attributes="checked python:id in ping_sites and 'checked' or None;
 		                    value id;
				    id id; "
                    />
             <label  for="id"
                     tal:content="python:here.portal_pingtool[id].Title()"
                     tal:attributes="for id" >Site name</label><br/>
           </tal:block>
          </div>

          <div class="formControls" 
               tal:define="process_creation request/process_creation|nothing;">
            <input type="submit"
                   value="Apply Changes"
                   name="form.button.Save"
                   class="context"
                   i18n:attributes="value label_apply_changes;"
                   />
            <input type="submit"
                   value="Cancel"
                   name="form.button.Cancel"
                   class="context"
                   i18n:attributes="value label_cancel;"
                   />
          </div>

        </fieldset>
        <fieldset>

          <legend i18n:translate="legend_ping">Ping Now</legend>

          <div class="formControls"
               tal:define="process_creation request/process_creation|nothing;">
            <input class="context"
                   type="submit"
                   name="form.button.Ping"
                   value="Ping"
                   i18n:attributes="value" 
                   />
          </div>

        </fieldset>

        <input type="hidden" name="form.submitted" value="1" />

      </form>

      <div metal:use-macro="here/document_byline/macros/byline">
        Get the byline - contains details about author and modification date.
      </div>

    </div>

  </body>
</html>
